# Stream to container "app"
upstream app {
  server app:3000;
}

server {
    listen 80 default_server;
    listen [::]:80;

    server_name furkankumas.com www.furkankumas.com;

    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_set_header Host $host;
    proxy_cache_bypass $http_upgrade;

    location /static {
            proxy_cache STATIC;
            proxy_ignore_headers Cache-Control;
            proxy_cache_valid 60m;
            proxy_pass http://app;
    }

    # No cache for dynamic assets
    location / {
        proxy_pass http://app;
  }
}